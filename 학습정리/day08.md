# ⚡️ 한입 Next 강의 정리

## 여덟째날

### 증분 정적 랜더링 (3nd: ISR)
- 뭔말이고?
  - SSG는 만들어둔 페이지만 계속 보여줌. 최신데이터 반영이 어려움. 단순히 SSG 방식으로 생성된 정적 페이지를 일정 시간 이후 다시 생성하게끔 만듦
    - 오... 이기술 새로고침했을때 반영못되던 그 기술 아닌가 싶네
  - 일종의 SSG에 유통기한을 설정해두는 느낌.
  - 매우 빠른 속도로 응답 가능(SSG 장점) + 최신 데이터 반영 가능 (SSR 장점)
- 적용방법
  - 매우 간단함. getStaticProps에 revalidate : 값 (초s)을 추가하면 됌.
- 가능하면 사전랜더링은 이 ISR 방식으로 적용하는게 좋음. 가장 강력한 사전랜더링 방식.

### 주문형 재 검증 (On-demand-ISR)
- but ISR 반영이 어려운 페이지가 있음
  -  시간과는 관계없이 사용자의 행동에 따라 데이터가 업데이트 되는거
    - 예를들어 커뮤니티 게시판의 수정, 삭제
    - 또한 불필요한 페이지가 계속 랜더링 될 수 있음
- 이러한 어려움이 생겨서 요청이 받을때마다 발생하는 ISR 방식 지원. 이것이 On-demand-ISR
- 적용방법
  - 1. revalidate 삭제
    2. 새로운 revalidate route handler 생성
    3. /api/revalidate 로 요청줄때마다 페이지 갱신이 이루어지게 됌
  - 그런데 너무 많은 데이터를 처리해야할게 아니라면 그냥 보편적인 ISR 방식으로 revalidate 시간을 넣어줘도 될듯
    - revalidate 시간 넣어두는건 사용자가 페이지에 접속하는것을 기준으로 트리거가 걸리기 때문.

### SEO 설정하기
- 섬네일 파일과 파비콘 파일은 public 폴더에 넣어둠
- next에서는 페이지별로 metatag 설정이 가능
- 다이나믹 SSG가 들어가고 있을 경우에는 사전랜더링 당시 메타태그가 걸리지 않으므로, fallback 상태일 때도 대체텍스트를 넣어두어야함
  - index페이지의 메타태크를 fallback 상태일때도 넣어두기.

### 배포하기
- 1. npm install -g vercel 설치
- 2. vercel login
- 3. vercel
  4. 이후 바로 프로덕션 배포를 하고 싶으면 vercel --prod
  5. 백엔드 서버도 똑같이 배포한 후에 백엔드 배포주소를 다시 프로젝트 url에 넣어둔다
  6. 본 프로젝트도 다시 재배포 하면 완료

---
### 느낀점
- ISR이 끝판왕 사전랜더링이구나 싶다. 사전랜더링의 모든 장점을 다 갖춰서... 이 방식대로 앱라우터는 어떻게 사용할 수 있을지 기대된다. 그리고 vercel은 모건님이 커맨드로 배포하는것만 봐오고 난 vercel 홈페이지상으로만 했어서 커맨드로 하는 배포가 궁금했는데 생각보다 그리 어렵진 않았더이다...!! 이대로 챌린지 프로젝트도 배포 가즈앗
